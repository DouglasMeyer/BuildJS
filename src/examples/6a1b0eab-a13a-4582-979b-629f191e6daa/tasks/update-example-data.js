#!/usr/bin/env node
var fs = require('fs');

fs.readdir('..', function(err, ids){
  if (err) {
    console.log('Error: ' + err);
    return;
  }

  var exampleDataService = '// NOTE: DO NOT EDIT: This file is generated by update-example-data.js\n';
  exampleDataService += "angular.module('BuildJS').service('ExampleData', function(){\n";
  exampleDataService += "  return {\n";
  for (var i=0,id; id=ids[i]; i++){
    if (i !== 0) exampleDataService += ',\n';
    var buffer = fs.readFileSync('../'+id+'/package.json');
    exampleDataService += '    "'+id+'": '+buffer.toString();
  }
  exampleDataService += "  };\n";
  exampleDataService += "});";

  fs.writeFile('src/example-data.js', exampleDataService, function(err){
    if (err) {
      console.log('Error: ' + err);
      return;
    }

    console.log(exampleDataService);
  });
});
